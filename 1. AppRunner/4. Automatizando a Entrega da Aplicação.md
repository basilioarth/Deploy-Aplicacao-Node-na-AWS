**Resumo da Aula: Configura√ß√£o de Pipeline CI/CD para AWS App Runner**  

---

### **Objetivo**  
Automatizar o deploy de uma aplica√ß√£o no **AWS App Runner** via GitHub Actions, resolvendo problemas de permiss√µes (IAM) e integra√ß√£o com o ECR.  

---

### **Principais Pontos Abordados**  

#### **1. Erro na Pipeline: Falta de Permiss√µes (IAM Role)**  
- **Problema**: A a√ß√£o `amazon-apprunner-deploy` exigia uma **ARN da role IAM** para acessar o App Runner.  
- **Causa**: A pipeline n√£o tinha permiss√£o para criar/atualizar servi√ßos no App Runner.  
- **Mensagem de Erro**:  
  ```  
  Error: Missing required input: access-role-arn  
  ```  

#### **2. Configura√ß√£o da Action no GitHub Actions**  
- **Arquivo `.github/workflows/main.yml`**:  
  ```yaml  
  - name: Deploy to App Runner  
    uses: aws-actions/amazon-apprunner-deploy@v1  
    with:  
      service-name: "widget-server"  
      image: "<ECR_URI>:v5"  
      region: "us-east-2"  
      cpu: "1 vCPU"  
      memory: "2 GB"  
      port: "3333"  
  ```  
  - **Par√¢metros Chave**:  
    - `service-name`: Nome do servi√ßo no App Runner.  
    - `image`: URI da imagem no ECR.  
    - `access-role-arn`: ARN da role IAM (a ser configurada).  

---

### **Solu√ß√£o do Problema**  

#### **Passo a Passo para Criar a Role IAM**  
1. **No Console AWS**:  
   - Acessar **IAM > Roles > Create Role**.  
   - Selecionar **App Runner** como servi√ßo confi√°vel.  
2. **Permiss√µes Necess√°rias**:  
   - `apprunner:CreateService`  
   - `apprunner:UpdateService`  
   - `ecr:DescribeImages` (para integra√ß√£o com ECR).  
3. **Criar e Vincular Pol√≠ticas**:  
   - Adicionar pol√≠ticas customizadas ou usar `AWSServiceRoleForAppRunner`.  

#### **Adicionar ARN da Role na Pipeline**  
- **GitHub Secrets**:  
  - Adicionar a vari√°vel `AWS_APP_RUNNER_ROLE_ARN` com o ARN da role criada.  
- **Atualizar o Workflow**:  
  ```yaml  
  with:  
    access-role-arn: ${{ secrets.AWS_APP_RUNNER_ROLE_ARN }}  
  ```  

---

### **Pr√≥ximos Passos (Aula Seguinte)**  
1. **Cria√ß√£o Detalhada da Role IAM**:  
   - Explica√ß√£o pr√°tica de pol√≠ticas e trust relationships.  
2. **Teste da Pipeline Atualizada**:  
   - Valida√ß√£o do deploy automatizado ap√≥s corre√ß√£o das permiss√µes.  
3. **Configura√ß√£o de Health Check HTTP**:  
   - Ajustar o endpoint `/health` para retornar status detalhados.  

---

**Conclus√£o**:  
A configura√ß√£o da pipeline CI/CD para o App Runner requer aten√ß√£o √†s permiss√µes IAM. Na pr√≥xima aula, finalizaremos a integra√ß√£o criando a role necess√°ria e validando o fluxo completo de deploy automatizado! üîßüöÄ